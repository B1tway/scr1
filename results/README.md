# Lab2: SCR1 sim

## Задание

|Вар|Вид исключения|Тест	            |Reset Vector	|Trap Vector   | При обработке
|----------|----------|---------------- |------------ |----------- |---------------
| 4 |	Load address misaligned|isa/rv32mi/ma_addr.S |0х600        |0x280     | Вывод строки «lMisalign»

## Выполнение

Для выполнения данной лабораторной работы было сделано:
1. В *[Makefile](../Makefile)*  значение параметра TRACE = 1, чтобы сгенерировался трейслог.
2. в riscv-isa оставлен 1 необходимый по варианту тест
3. Изменен trap_vector в файле *[riscv_macros.h](../sim/tests/common/riscv_macros.h)*. При обработке load address misaligned исключения выводится строка "lMisalign". 
4. В *[scr1_arch_description.svh](../src/includes/scr1_arch_description.svh)* параметры ядра выставлены в соотвествии с вариантом. 
5. Изменен linker-скрипт *[link.ld](../sim/tests/common/link.ld)* и *[riscv_macros.h](../sim/tests/common/riscv_macros.h)*. Для выполения условий задания, перед *_start* обьявлена секция reset. 
```
.text.init 0 : { 
    FILL(0);
    . = 0x100 - 12;
    SIM_EXIT = .;
    LONG(0x13);
    SIM_STOP = .;
    LONG(0x6F);
    LONG(-1);
    . = 0x280;
    PROVIDE(__TEXT_START__ = .);
    *(.text.init)
    . = 0x600;
    *(.text.reset)
  } >RAM
``` 
6. Симуляция теста проходит успешно. Строка выводится только для исключений по варианту
7. Создана директория *results* с результатами выполнения. 

## Результаты

* На основе результа в **test_results.txt** видно, что был выбран только необходимый тест, который успешно выполнился.
* На основе дампа **ma_addr.dump** видно, что *trap_vector* располагается по адресу 0x280, а *_start* по адресу 0x600
* Из трейслога **tracelog_core_0.log** видно, что работа начинается с адреса 0х600 и при возникновении exception переходит по адресу 0x280.

## Вывод
Мне понравилось. Не думал, что копаться в конфигурациях может быть так интересно ) 
